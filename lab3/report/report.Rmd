---
title: "732A62 Lab 3"
author: "Emil K Svensson & Rasmus Holm"
date: "`r Sys.Date()`"
output:
    pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Assignment 1

## 1)

```{r}
library(astsa)
library(TSA)
library(forecast)

plot(chicken)
```

It looks like a linear, potentially quadratic, trend.

## 2)

```{r}
lm_data <- data.frame(chicken=chicken, time=1:length(chicken))
lm_fit <- lm(chicken ~ time, lm_data)
z <- resid(lm_fit)
plot(z, type="l", ylab="resid", xlab="Time")
```

The residuals do not look stationary.

## 3)

```{r}
periodogram(fft(z))
```

## 4)

```{r}

```

## 5)

```{r}

```

## 6)

```{r}

fit_plot <- function(model, data) {
    nahead <- 36
    pred <- predict(model, n.ahead=nahead, se.fit=TRUE)
    upper_band <- pred$pred + 1.96 * pred$se
    lower_band <- pred$pred - 1.96 * pred$se

    n <- length(data)

    plot(c(data, pred$pred), type="l",
         xlim=c(n - nahead, n + nahead),
         ylim=c(min(lower_band), max(upper_band)), ylab="Value", xlab="Time")
    lines(n + 1:nahead, upper_band, lty=2, col="red")
    lines(n + 1:nahead, lower_band, lty=2, col="red")
}
```

```{r}
fit <- arima(chicken, order=c(2, 1, 0), seasonal=list(order=c(0, 0, 1), period=12))
fit_plot(fit, chicken)
```

## 7)

```{r}
fit <- arima(chicken, order=c(3, 0, 0), seasonal=list(order=c(0, 0, 1), period=12))
fit_plot(fit, chicken)
```

\newpage

# Assignment 2

## 1)

```{r}

```

## 2)

```{r}

```

## 3)

```{r}

```

## 4)

```{r}

```

## 5)

```{r}

```

## 6)

```{r}

```
